// 1.25m cupola (SSPXR)

@PART[sspx-cupola-125-1]:NEEDS[StationPartsExpansionRedux]:BEFORE[BonVoyage]
{
	%addBonVoyage = True
}

// Phoebe (NF Spacecraft)

@PART[command-125-orbit-1]:NEEDS[NearFutureSpacecraft]:BEFORE[BonVoyage]
{
	%addBonVoyage = True
}

// todo: Planetside MMSEV?

@PART:HAS[#addBonVoyage[True]]:BEFORE[BonVoyage]
{
	MODULE
	{
		name = BonVoyageModule
		showUpgradesInModuleInfo = false
		shutdown = True // launch inactive
		UPGRADES
		{
			UPGRADE
			{
				name__ = BonVoyageUpgrade_v2
				techRequired__ = unmannedTech
				techLevel = 2
			}
			UPGRADE
			{
				name__ = BonVoyageUpgrade_v3
				techRequired__ = automation
				techLevel = 3
			}
		}
	}
}

// Cleanup

@PART:HAS[#addBonVoyage]:AFTER[BonVoyage]
{
	!addBonVoyage = remove
}

@PART:HAS[@MODULE[BonVoyageModule]:HAS[@UPGRADES:HAS[!UPGRADE:HAS[#name__[BonVoyageUpgrade_v4]]]]]:NEEDS[CommunityTechTree]:LAST[BonVoyage]
{
    @MODULE[BonVoyageModule]
    {
        @UPGRADES
        {
            UPGRADE
            {
                name__ = BonVoyageUpgrade_v4
                techRequired__ = artificialIntelligence
                techLevel = 4
            }
        }
    }
}

// remove per-part costs from PartUpgrades due to VAB display error

@PARTUPGRADE[BonVoyageUpgrade*]:AFTER[BonVoyage]
{
    @cost = 0
}

// Change PartUpgrade images

@PARTUPGRADE[BonVoyageUpgrade_v2]:LAST[BonVoyage]
{
    @partIcon = roverWheel2
}

@PARTUPGRADE[BonVoyageUpgrade_v3]:LAST[BonVoyage]
{
    @partIcon = roverWheel1
}

@PARTUPGRADE[BonVoyageUpgrade_v4]:LAST[BonVoyage]:NEEDS[CommunityTechTree]
{
    @partIcon = wheelMed
}
