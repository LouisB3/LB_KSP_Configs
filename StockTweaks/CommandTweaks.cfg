//Add data transmitter to command modules without it
@PART[*]:HAS[@MODULE[ModuleCommand],!MODULE[ModuleDataTransmitter]]:FINAL
{
  MODULE
  {
    name = ModuleDataTransmitter
    antennaType = INTERNAL
    packetInterval = 1.0
    packetSize = 2
    packetResourceCost = 12.0
    requiredResource = ElectricCharge
    antennaPower = 5000
    optimumRange = 2500
    packetFloor = .1
    packetCeiling = 5
  }
}

//Add hibernation to probe cores without it
//Enable warp hibernation by default
@PART[*]:HAS[@MODULE[ModuleCommand]:HAS[#minimumCrew[0]]]
{
	@MODULE[ModuleCommand]
	{
		%hasHibernation = true
    %hibernateOnWarp = true
	}
}

//Command pod monopropellant is empty by default
@PART[*]:HAS[@MODULE[ModuleCommand],@RESOURCE[MonoPropellant]]:FINAL
{
  @RESOURCE[MonoPropellant]
  {
    @amount = 0
  }
}

//Reduce probe control points to require only one pilot
@PART[*]:HAS[@MODULE[ModuleProbeControlPoint]]:FINAL {
	@MODULE[ModuleProbeControlPoint] {
		@minimumCrew = 1
	}
}

//Default all crewable parts to empty by overwriting BetterCrewAssignmentâ€™s configurations
@PART[*]:HAS[@MODULE[ModuleCrewAssignment]]:FINAL {
	@MODULE[ModuleCrewAssignment] {
		@defaultAssignment = Empty
	}
}

//add MechJeb to all command modules
@PART[*]:HAS[@MODULE[ModuleCommand],!MODULE[MechJebCore]]:NEEDS[MechJeb2]:FINAL
{
    MODULE
    {
        name = MechJebCore
    }
}

//Add high-density kOS capacity to probe cores with advanced SAS
@PART[*]:HAS[@MODULE[ModuleCommand]:HAS[#minimumCrew[0]],@MODULE[ModuleSAS]:HAS[#SASServiceLevel[3]],!MODULE[kOSProcessor]]:NEEDS[kOS]
{
  MODULE
  {
  	name = kOSProcessor
  	diskSpace = 1000000
    @diskSpace *= #$../mass$
  	ECPerBytePerSecond = 0
  	ECPerInstruction = 0.000004
  }
}

//Add medium-density kOS capacity to all other probe cores with SAS
@PART[*]:HAS[@MODULE[ModuleCommand]:HAS[#minimumCrew[0]],@MODULE[ModuleSAS],!MODULE[kOSProcessor]]:NEEDS[kOS]
{
  MODULE
  {
  	name = kOSProcessor
  	diskSpace = 100000
    @diskSpace *= #$../mass$
  	ECPerBytePerSecond = 0
  	ECPerInstruction = 0.000004
  }
}

//Add low-density kOS capacity to command pods
@PART[*]:HAS[@MODULE[ModuleCommand]:HAS[#minimumCrew[>0]],!MODULE[kOSProcessor]]:NEEDS[kOS]
{
  MODULE
  {
  	name = kOSProcessor
  	diskSpace = 10000
    @diskSpace *= #$../mass$
  	ECPerBytePerSecond = 0
  	ECPerInstruction = 0.000004
  }
}

//Probe-pod hybrids get medium-density capacity
@PART[*]:HAS[@MODULE[ModuleCommand]:HAS[#minimumCrew[0]],@MODULE[ModuleSAS],#CrewCapacity[>0]]:NEEDS[kOS]
{
  %MODULE[kOSProcessor]
  {
  	%diskSpace = 100000
    @diskSpace *= #$../mass$
    %ECPerBytePerSecond = 0
  	%ECPerInstruction = 0.000004
  }
}

//Empty all crewable parts of Snacks by default
@PART[*]:HAS[#CrewCapacity[>0],@RESOURCE[Snacks]]:FINAL
{
  @RESOURCE[Snacks]
  {
    @amount = 0
  }
}
